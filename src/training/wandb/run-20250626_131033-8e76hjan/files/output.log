âœ… Created open loop trainer for cyclic sequences
   ğŸ¯ Experiment: open_cyclic_20250626_131033
   ğŸ” Loop mode: open
   ğŸ“Š Cycle penalty: 1.0
   ğŸš€ Riemannian: True (geodesic)

ğŸš€ Starting OPEN loop training on cyclic sequences
Loading cyclic sprites data from /scratch/alaforgu/longitudinal_experiments/RlVAE/data/processed/Sprites_train_cyclic.pt...
Cyclic sprites data shape: torch.Size([3000, 8, 3, 64, 64])
Data range: [0.000, 0.996]
âœ… train cyclic dataset size: 10
âœ… Final data shape: torch.Size([10, 8, 3, 64, 64])
âœ… Final data range: [0.000, 0.996]
ğŸ” Verifying cyclicity of first 5 sequences:
   Seq 0: MSE = 0.00e+00
   Seq 1: MSE = 0.00e+00
   Seq 2: MSE = 0.00e+00
   Seq 3: MSE = 0.00e+00
   Seq 4: MSE = 0.00e+00
Loading cyclic sprites data from /scratch/alaforgu/longitudinal_experiments/RlVAE/data/processed/Sprites_train_cyclic.pt...
Cyclic sprites data shape: torch.Size([3000, 8, 3, 64, 64])
Data range: [0.000, 0.996]
âœ… train cyclic dataset size: 5
âœ… Final data shape: torch.Size([5, 8, 3, 64, 64])
âœ… Final data range: [0.000, 0.996]
ğŸ” Verifying cyclicity of first 5 sequences:
   Seq 0: MSE = 0.00e+00
   Seq 1: MSE = 0.00e+00
   Seq 2: MSE = 0.00e+00
   Seq 3: MSE = 0.00e+00
   Seq 4: MSE = 0.00e+00

ğŸ“ˆ Epoch 1/1 - OPEN Mode
 ... (more hidden) ...
ğŸ§  USING RIEMANNIAN METRIC-AWARE POSTERIOR (batch_size=2)
ğŸ§  Creating sequence trajectory visualization for epoch 0
ğŸ¬ Creating comprehensive reconstruction visualization for epoch 0
ğŸ”¬ Creating manifold visualizations for epoch 0
ğŸ“Š Analyzing 2 sequences with 8 timesteps
ğŸ“ Computing metrics for timestep 1/8 using flow-evolved coordinates
   Computing G(z) at 100 flow-evolved points...
   âœ… Computed metrics: det(Gâ»Â¹) range [1.37e-13, 2.24e-09]
   âœ… Timestep 0 data collected (metrics: 7 properties)
ğŸ“ Computing metrics for timestep 2/8 using flow-evolved coordinates
   Computing G(z) at 100 flow-evolved points...
   âœ… Computed metrics: det(Gâ»Â¹) range [1.98e-15, 9.26e-09]
   âœ… Timestep 1 data collected (metrics: 7 properties)
ğŸ“ Computing metrics for timestep 3/8 using flow-evolved coordinates
   Computing G(z) at 100 flow-evolved points...
   âœ… Computed metrics: det(Gâ»Â¹) range [1.17e-15, 1.17e-08]
   âœ… Timestep 2 data collected (metrics: 7 properties)
ğŸ“ Computing metrics for timestep 4/8 using flow-evolved coordinates
   Computing G(z) at 100 flow-evolved points...
   âœ… Computed metrics: det(Gâ»Â¹) range [9.30e-15, 8.47e-08]
   âœ… Timestep 3 data collected (metrics: 7 properties)
ğŸ“ Computing metrics for timestep 5/8 using flow-evolved coordinates
   Computing G(z) at 100 flow-evolved points...
   âœ… Computed metrics: det(Gâ»Â¹) range [5.58e-16, 4.74e-08]
   âœ… Timestep 4 data collected (metrics: 7 properties)
ğŸ“ Computing metrics for timestep 6/8 using flow-evolved coordinates
   Computing G(z) at 100 flow-evolved points...
   âœ… Computed metrics: det(Gâ»Â¹) range [2.69e-15, 1.72e-08]
   âœ… Timestep 5 data collected (metrics: 7 properties)
ğŸ“ Computing metrics for timestep 7/8 using flow-evolved coordinates
   Computing G(z) at 100 flow-evolved points...
   âœ… Computed metrics: det(Gâ»Â¹) range [2.28e-15, 1.54e-09]
   âœ… Timestep 6 data collected (metrics: 7 properties)
ğŸ“ Computing metrics for timestep 8/8 using flow-evolved coordinates
   Computing G(z) at 100 flow-evolved points...
   âœ… Computed metrics: det(Gâ»Â¹) range [1.96e-16, 1.26e-08]
   âœ… Timestep 7 data collected (metrics: 7 properties)
ğŸ¨ Creating visualizations with metrics for 8 timesteps...
ğŸ“ˆ Creating enhanced PCA analysis with flow-evolved coordinates...
âœ… Enhanced PCA analysis created: 8/8 timesteps have metrics
ğŸ”¥ Creating enhanced manifold heatmaps with flow-evolved coordinates...
âœ… Enhanced manifold heatmaps created
â±ï¸ Creating temporal metric analysis...
âœ… Temporal metric analysis created: 8/8 timesteps analyzed
âœ¨ Manifold visualizations complete for epoch 0
ğŸŒ Creating enhanced geodesic & metric impact visualizations for epoch 0
ğŸŒ Creating INTERACTIVE geodesic slider visualization with timestep evolution...
ğŸ“Š Computing DYNAMIC geodesic background fields for each timestep...
   Computing background fields for timestep 0...
     âœ… Geodesic background computed for t=0: det(G) range [5.57e+00, 8.94e+02]
   Computing background fields for timestep 1...
     ğŸ”„ Applying 1 forward flow steps to geodesic grid...
       Applying flow 0: z_0 â†’ z_1
     âœ… Geodesic grid transformed to timestep 1 coordinate system
     âœ… Geodesic background computed for t=1: det(G) range [8.51e+00, 1.68e+03]
   Computing background fields for timestep 2...
     ğŸ”„ Applying 2 forward flow steps to geodesic grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
     âœ… Geodesic grid transformed to timestep 2 coordinate system
     âœ… Geodesic background computed for t=2: det(G) range [8.79e+00, 1.65e+03]
   Computing background fields for timestep 3...
     ğŸ”„ Applying 3 forward flow steps to geodesic grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
       Applying flow 2: z_2 â†’ z_3
     âœ… Geodesic grid transformed to timestep 3 coordinate system
     âœ… Geodesic background computed for t=3: det(G) range [5.61e+00, 1.99e+03]
   Computing background fields for timestep 4...
     ğŸ”„ Applying 4 forward flow steps to geodesic grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
       Applying flow 2: z_2 â†’ z_3
       Applying flow 3: z_3 â†’ z_4
     âœ… Geodesic grid transformed to timestep 4 coordinate system
     âœ… Geodesic background computed for t=4: det(G) range [6.14e+00, 3.63e+03]
   Computing background fields for timestep 5...
     ğŸ”„ Applying 5 forward flow steps to geodesic grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
       Applying flow 2: z_2 â†’ z_3
       Applying flow 3: z_3 â†’ z_4
       Applying flow 4: z_4 â†’ z_5
     âœ… Geodesic grid transformed to timestep 5 coordinate system
     âœ… Geodesic background computed for t=5: det(G) range [5.23e+00, 3.63e+03]
   Computing background fields for timestep 6...
     ğŸ”„ Applying 6 forward flow steps to geodesic grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
       Applying flow 2: z_2 â†’ z_3
       Applying flow 3: z_3 â†’ z_4
       Applying flow 4: z_4 â†’ z_5
       Applying flow 5: z_5 â†’ z_6
     âœ… Geodesic grid transformed to timestep 6 coordinate system
     âœ… Geodesic background computed for t=6: det(G) range [6.19e+00, 6.42e+03]
   Computing background fields for timestep 7...
     ğŸ”„ Applying 7 forward flow steps to geodesic grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
       Applying flow 2: z_2 â†’ z_3
       Applying flow 3: z_3 â†’ z_4
       Applying flow 4: z_4 â†’ z_5
       Applying flow 5: z_5 â†’ z_6
       Applying flow 6: z_6 â†’ z_7
     âœ… Geodesic grid transformed to timestep 7 coordinate system
     âœ… Geodesic background computed for t=7: det(G) range [5.95e+00, 4.33e+03]
    âœ… Geodesic slider: Using FLOW-EVOLVED coordinates for timestep 0
    âœ… Geodesic slider: Using FLOW-EVOLVED coordinates for timestep 1
    âœ… Geodesic slider: Using FLOW-EVOLVED coordinates for timestep 2
    âœ… Geodesic slider: Using FLOW-EVOLVED coordinates for timestep 3
    âœ… Geodesic slider: Using FLOW-EVOLVED coordinates for timestep 4
    âœ… Geodesic slider: Using FLOW-EVOLVED coordinates for timestep 5
    âœ… Geodesic slider: Using FLOW-EVOLVED coordinates for timestep 6
    âœ… Geodesic slider: Using FLOW-EVOLVED coordinates for timestep 7
   ğŸ“Š Geodesic frame 0: using det_G background range [5.57e+00, 8.94e+02]
   ğŸ“Š Geodesic frame 1: using det_G background range [8.51e+00, 1.68e+03]
   ğŸ“Š Geodesic frame 2: using det_G background range [8.79e+00, 1.65e+03]
   ğŸ“Š Geodesic frame 3: using det_G background range [5.61e+00, 1.99e+03]
   ğŸ“Š Geodesic frame 4: using det_G background range [6.14e+00, 3.63e+03]
   ğŸ“Š Geodesic frame 5: using det_G background range [5.23e+00, 3.63e+03]
   ğŸ“Š Geodesic frame 6: using det_G background range [6.19e+00, 6.42e+03]
   ğŸ“Š Geodesic frame 7: using det_G background range [5.95e+00, 4.33e+03]
/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/kaleido/__init__.py:14: UserWarning:



Warning: You have Plotly version 5.24.1, which is not compatible with this version of Kaleido (1.0.0).

This means that static image generation (e.g. `fig.write_image()`) will not work.

Please upgrade Plotly to version 6.1.1 or greater, or downgrade Kaleido to version 0.2.1.
âš ï¸ Interactive geodesic slider visualization failed:
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido


Traceback (most recent call last):
  File "/scratch/alaforgu/longitudinal_experiments/RlVAE/src/training/train_cyclic_loop_comparison.py", line 3074, in _create_interactive_geodesic_slider_visualization
    fig.write_image(png_filename, width=1600, height=1000, scale=2)
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/basedatatypes.py", line 3835, in write_image
    return pio.write_image(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/io/_kaleido.py", line 266, in write_image
    img_data = to_image(
               ^^^^^^^^^
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/io/_kaleido.py", line 132, in to_image
    raise ValueError(
ValueError:
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido

âœ… Enhanced geodesic visualization created for epoch 0
âœ¨ Creating FANCY interactive geodesic visualizations...
âœ¨ Creating FANCY interactive geodesic visualizations for epoch 0
âš ï¸ Fancy visualization failed:
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido

Traceback (most recent call last):
  File "/scratch/alaforgu/longitudinal_experiments/RlVAE/src/training/train_cyclic_loop_comparison.py", line 3673, in create_fancy_interactive_geodesic_visualizations
    fig.write_image(png_filename, width=1600, height=1000, scale=2)
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/basedatatypes.py", line 3835, in write_image
    return pio.write_image(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/io/_kaleido.py", line 266, in write_image
    img_data = to_image(
               ^^^^^^^^^
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/io/_kaleido.py", line 132, in to_image
    raise ValueError(
ValueError:
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido

ğŸ¬ Creating TEMPORAL metric evolution visualization...
ğŸŒŠ Creating FLOW-BASED temporal metric evolution visualization for epoch 0
ğŸŒŠ Computing flow-based det(G) evolution for 2 sequences with 8 timesteps
ğŸ“ Computing base metric det(G(z_i0))...
   Base det(G) range: [1.406e+07, 7.241e+09]
ğŸŒŠ Propagating det(G) through flow chain...
   Flow step 1: z_0 â†’ z_1
     |J_flow_1| range: [1.163, 1.168]
     det(G) range: [1.635e+07, 8.454e+09]
   Flow step 2: z_1 â†’ z_2
     |J_flow_2| range: [0.880, 0.913]
     det(G) range: [1.493e+07, 7.437e+09]
   Flow step 3: z_2 â†’ z_3
     |J_flow_3| range: [1.002, 1.019]
     det(G) range: [1.522e+07, 7.455e+09]
   Flow step 4: z_3 â†’ z_4
     |J_flow_4| range: [0.882, 0.893]
     det(G) range: [1.343e+07, 6.659e+09]
   Flow step 5: z_4 â†’ z_5
     |J_flow_5| range: [0.832, 0.839]
     det(G) range: [1.118e+07, 5.590e+09]
   Flow step 6: z_5 â†’ z_6
     |J_flow_6| range: [0.986, 0.994]
     det(G) range: [1.102e+07, 5.557e+09]
   Flow step 7: z_6 â†’ z_7
     |J_flow_7| range: [0.742, 0.760]
     det(G) range: [8.375e+06, 4.123e+09]
âœ… Flow-based evolution complete!
   Final det(G) range: [8.375e+06, 8.454e+09]
   Det(G) amplification: 0.569x
ğŸ“Š PCA projection complete (explained variance: 97.8%)
ğŸ”¥ Computing spatial det(G) heatmaps for each timestep...
   Computing spatial heatmap for timestep 0...
   Computing spatial heatmap for timestep 1...
     âœ… Computed heatmap for t=1: det(G) range [9.93e+07, 7.86e+27]
   Computing spatial heatmap for timestep 2...
     âœ… Computed heatmap for t=2: det(G) range [9.30e+07, 4.26e+27]
   Computing spatial heatmap for timestep 3...
     âœ… Computed heatmap for t=3: det(G) range [1.30e+06, 1.70e+27]
   Computing spatial heatmap for timestep 4...
     âœ… Computed heatmap for t=4: det(G) range [6.81e+05, 3.90e+28]
   Computing spatial heatmap for timestep 5...
     âœ… Computed heatmap for t=5: det(G) range [4.17e+04, 1.84e+30]
   Computing spatial heatmap for timestep 6...
     âœ… Computed heatmap for t=6: det(G) range [5.52e+04, 1.81e+31]
   Computing spatial heatmap for timestep 7...
     âœ… Computed heatmap for t=7: det(G) range [3.45e+04, 3.37e+30]
âœ… Computed 8 spatial heatmaps with evolving det(G) fields!
âš ï¸ Flow-based interactive animation failed:
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido

Traceback (most recent call last):
  File "/scratch/alaforgu/longitudinal_experiments/RlVAE/src/training/train_cyclic_loop_comparison.py", line 5242, in _create_flow_based_interactive_animation
    fig.write_image(png_filename, width=1600, height=900, scale=2)
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/basedatatypes.py", line 3835, in write_image
    return pio.write_image(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/io/_kaleido.py", line 266, in write_image
    img_data = to_image(
               ^^^^^^^^^
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/io/_kaleido.py", line 132, in to_image
    raise ValueError(
ValueError:
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido

âš ï¸ Interactive temporal animation failed:
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido

Traceback (most recent call last):
  File "/scratch/alaforgu/longitudinal_experiments/RlVAE/src/training/train_cyclic_loop_comparison.py", line 5585, in _create_interactive_temporal_animation
    fig.write_image(png_filename, width=1600, height=800, scale=2)
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/basedatatypes.py", line 3835, in write_image
    return pio.write_image(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/io/_kaleido.py", line 266, in write_image
    img_data = to_image(
               ^^^^^^^^^
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/io/_kaleido.py", line 132, in to_image
    raise ValueError(
ValueError:
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido

âœ¨ Flow-based temporal metric evolution visualization created for epoch 0!
ğŸ”¥ Creating moderate-detail heatmaps...
ğŸŒŸ Creating MODERATE-DETAIL metric heatmap for epoch 0
ğŸ“Š Computing metrics on 10000 moderate-resolution grid points...
ğŸ¬ Creating INTERACTIVE metric slider visualization with timestep evolution...
ğŸ”„ Computing metric fields for timesteps 0 to 7...
ğŸ“Š Computing DYNAMIC metric heatmaps for each timestep...
   Computing heatmap for timestep 0...
     âœ… Heatmap computed for t=0: det(G) range [7.44e+04, 6.92e+28]
   Computing heatmap for timestep 1...
     ğŸ”„ Applying 1 forward flow steps to grid...
       Applying flow 0: z_0 â†’ z_1
     âœ… Grid transformed to timestep 1 coordinate system
     âœ… Heatmap computed for t=1: det(G) range [3.57e+05, 2.80e+30]
   Computing heatmap for timestep 2...
     ğŸ”„ Applying 2 forward flow steps to grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
     âœ… Grid transformed to timestep 2 coordinate system
     âœ… Heatmap computed for t=2: det(G) range [2.55e+05, 3.31e+30]
   Computing heatmap for timestep 3...
     ğŸ”„ Applying 3 forward flow steps to grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
       Applying flow 2: z_2 â†’ z_3
     âœ… Grid transformed to timestep 3 coordinate system
     âœ… Heatmap computed for t=3: det(G) range [2.87e+04, 2.21e+30]
   Computing heatmap for timestep 4...
     ğŸ”„ Applying 4 forward flow steps to grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
       Applying flow 2: z_2 â†’ z_3
       Applying flow 3: z_3 â†’ z_4
     âœ… Grid transformed to timestep 4 coordinate system
     âœ… Heatmap computed for t=4: det(G) range [2.01e+04, 1.46e+31]
   Computing heatmap for timestep 5...
     ğŸ”„ Applying 5 forward flow steps to grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
       Applying flow 2: z_2 â†’ z_3
       Applying flow 3: z_3 â†’ z_4
       Applying flow 4: z_4 â†’ z_5
     âœ… Grid transformed to timestep 5 coordinate system
     âœ… Heatmap computed for t=5: det(G) range [1.77e+04, 2.80e+31]
   Computing heatmap for timestep 6...
     ğŸ”„ Applying 6 forward flow steps to grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
       Applying flow 2: z_2 â†’ z_3
       Applying flow 3: z_3 â†’ z_4
       Applying flow 4: z_4 â†’ z_5
       Applying flow 5: z_5 â†’ z_6
     âœ… Grid transformed to timestep 6 coordinate system
     âœ… Heatmap computed for t=6: det(G) range [1.33e+05, 4.93e+31]
   Computing heatmap for timestep 7...
     ğŸ”„ Applying 7 forward flow steps to grid...
       Applying flow 0: z_0 â†’ z_1
       Applying flow 1: z_1 â†’ z_2
       Applying flow 2: z_2 â†’ z_3
       Applying flow 3: z_3 â†’ z_4
       Applying flow 4: z_4 â†’ z_5
       Applying flow 5: z_5 â†’ z_6
       Applying flow 6: z_6 â†’ z_7
     âœ… Grid transformed to timestep 7 coordinate system
     âœ… Heatmap computed for t=7: det(G) range [3.51e+03, 3.82e+31]

/scratch/alaforgu/longitudinal_experiments/RlVAE/src/training/train_cyclic_loop_comparison.py:889: UserWarning:

To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
    âœ… Using FLOW-EVOLVED coordinates for timestep 0
    âœ… Using FLOW-EVOLVED coordinates for timestep 1
    âœ… Using FLOW-EVOLVED coordinates for timestep 2
    âœ… Using FLOW-EVOLVED coordinates for timestep 3
    âœ… Using FLOW-EVOLVED coordinates for timestep 4
    âœ… Using FLOW-EVOLVED coordinates for timestep 5
    âœ… Using FLOW-EVOLVED coordinates for timestep 6
    âœ… Using FLOW-EVOLVED coordinates for timestep 7
   ğŸ“Š Frame 0: using det_heatmap range [7.44e+04, 6.92e+28]
   ğŸ“Š Frame 1: using det_heatmap range [3.57e+05, 2.80e+30]
   ğŸ“Š Frame 2: using det_heatmap range [2.55e+05, 3.31e+30]
   ğŸ“Š Frame 3: using det_heatmap range [2.87e+04, 2.21e+30]
   ğŸ“Š Frame 4: using det_heatmap range [2.01e+04, 1.46e+31]
   ğŸ“Š Frame 5: using det_heatmap range [1.77e+04, 2.80e+31]
   ğŸ“Š Frame 6: using det_heatmap range [1.33e+05, 4.93e+31]
   ğŸ“Š Frame 7: using det_heatmap range [3.51e+03, 3.82e+31]
âš ï¸ Interactive metric slider visualization failed:
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido

Traceback (most recent call last):
  File "/scratch/alaforgu/longitudinal_experiments/RlVAE/src/training/train_cyclic_loop_comparison.py", line 1166, in _create_interactive_metric_slider_visualization
    fig.write_image(png_filename, width=1600, height=1000, scale=2)
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/basedatatypes.py", line 3835, in write_image
    return pio.write_image(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/io/_kaleido.py", line 266, in write_image
    img_data = to_image(
               ^^^^^^^^^
  File "/scratch/alaforgu/miniconda3/lib/python3.12/site-packages/plotly/io/_kaleido.py", line 132, in to_image
    raise ValueError(
ValueError:
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido

âœ… Moderate detail metric heatmap created with 10000 points
âœ… Epoch 0: Train Loss: 8693.1792, Val Loss: 2706.8965, Cycle: 0.0000
ğŸ’¾ Saved best open model (val_loss: 2706.8965)

ğŸ‰ OPEN training completed!

ğŸŒŠ Generating final curvature analysis...
Loading cyclic sprites data from /scratch/alaforgu/longitudinal_experiments/RlVAE/data/processed/Sprites_test_cyclic.pt...
Cyclic sprites data shape: torch.Size([888, 8, 3, 64, 64])
Data range: [0.000, 0.996]
âœ… val cyclic dataset size: 5
âœ… Final data shape: torch.Size([5, 8, 3, 64, 64])
âœ… Final data range: [0.000, 0.996]
ğŸ” Verifying cyclicity of first 5 sequences:
   Seq 0: MSE = 0.00e+00
   Seq 1: MSE = 0.00e+00
   Seq 2: MSE = 0.00e+00
   Seq 3: MSE = 0.00e+00
   Seq 4: MSE = 0.00e+00
ğŸŒŠ Creating timestep-specific curvature analysis for epoch 0
PCA variance explained: [0.987431   0.00578254]
Computing curvature for all timesteps...
  Timestep 0/7
  Timestep 1/7
  Timestep 2/7
